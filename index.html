<!DOCTYPE html>
<html>
<head>
  <title>Sales Form</title>
</head>
<body>
  <h2>Sales Report</h2>
  <form id="salesForm">
    <label>Date: <input type="date" name="Date" required></label><br><br>
    <label>Salesperson: <input type="text" name="Salesperson" required></label><br><br>
    <label>Product: <input type="text" name="Product" required></label><br><br>
    <label>Quantity: <input type="number" name="Quantity" required></label><br><br>
    <label>Price: <input type="number" name="Price" step="0.01" required></label><br><br>
    <label>Total: <input type="number" name="Total" step="0.01" required></label><br><br>
    <button type="submit">Submit</button>
  </form>

  <script>
    const webAppUrl = "https://script.google.com/macros/s/AKfycbxTcwpg3zUfb7yLgZ7kkygeyW_MS1X64ehi28lDveCAUmMYoJk2JAO8oiRPWIWLwMl6Iw/exec"; // Replace with your Google Apps Script URL
    const ownerPhone = "254722868475"; // Replace with the owner WhatsApp number in international format

    document.getElementById('salesForm').addEventListener('submit', async function(e) {
      e.preventDefault();

      const formData = new FormData(e.target);
      const data = {};
      formData.forEach((value, key) => data[key] = value);

      // Send data to Google Sheets
      try {
        await fetch(webAppUrl, {
          method: 'POST',
          mode: 'no-cors',  // bypass CORS restrictions
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
      } catch (error) {
        alert('Error sending data: ' + error);
        return;
      }

      // Prepare WhatsApp message
      const message = encodeURIComponent(
        `New Sales Report:\n` +
        `Date: ${data.Date}\n` +
        `Salesperson: ${data.Salesperson}\n` +
        `Product: ${data.Product}\n` +
        `Quantity: ${data.Quantity}\n` +
        `Price: ${data.Price}\n` +
        `Total: ${data.Total}`
      );

      // Open WhatsApp chat with pre-filled message
      const waUrl = `https://wa.me/${ownerPhone}?text=${message}`;
      window.open(waUrl, '_blank');

      // Reset form after submission
      e.target.reset();
      alert('Sales data submitted and WhatsApp message ready.');
    });
  </script>
</body>
</html>
