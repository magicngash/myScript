<!DOCTYPE html>
<html>
<head>
  <title>Sales Form</title>
</head>
<body>
  <h2>Sales Report</h2>
  <form id="salesForm">
    <label>Date: <input type="date" name="Date" required></label><br><br>
    <label>Salesperson: <input type="text" name="Salesperson" required></label><br><br>
    <label>Product: <input type="text" name="Product" required></label><br><br>
    <label>Quantity: <input type="number" name="Quantity" required></label><br><br>
    <label>Price: <input type="number" name="Price" step="0.01" required></label><br><br>
    <label>Total: <input type="number" name="Total" step="0.01" required></label><br><br>

    <button type="button" id="sendToSheets">Send to Google Sheets</button>
    <button type="button" id="sendToWhatsApp">Send WhatsApp Message</button>
  </form>

  <script>
    const webAppUrl = "https://script.google.com/macros/s/AKfycbxTcwpg3zUfb7yLgZ7kkygeyW_MS1X64ehi28lDveCAUmMYoJk2JAO8oiRPWIWLwMl6Iw/exec"; // Replace with your Google Apps Script URL
    const ownerPhone = "254722868475"; // Replace with WhatsApp number

    const form = document.getElementById('salesForm');

    // Helper: get form data as object
    function getFormData() {
      const formData = new FormData(form);
      const data = {};
      formData.forEach((value, key) => data[key] = value);
      return data;
    }

    // Send data to Google Sheets
    document.getElementById('sendToSheets').addEventListener('click', async () => {
      const data = getFormData();
      try {
        await fetch(webAppUrl, {
          method: 'POST',
          mode: 'no-cors',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        alert("Data sent to Google Sheets!");
      } catch (error) {
        alert("Error sending to Google Sheets: " + error);
      }
    });

    // Open WhatsApp with message
    document.getElementById('sendToWhatsApp').addEventListener('click', () => {
      const data = getFormData();
      const message = encodeURIComponent(
        `New Sales Report:\n` +
        `Date: ${data.Date}\n` +
        `Salesperson: ${data.Salesperson}\n` +
        `Product: ${data.Product}\n` +
        `Quantity: ${data.Quantity}\n` +
        `Price: ${data.Price}\n` +
        `Total: ${data.Total}`
      );
      const waUrl = `https://wa.me/${ownerPhone}?text=${message}`;
      window.open(waUrl, '_blank');
    });
  </script>
</body>
</html>
